Losses= scan()
524000000
524000000
24000000
400000000
524000000
100000
1000000
900000
200000
29000000
29000000
100000
150000
8000000
6000000
8000000
1000000
39250000
38500000
40000000
3500000
19000000
6000000
100000
150000
33000000
6000000
6000000
33000000
100000
1100000
1750000
1500000
2000000
250000
25000000
25000000
52500000
80000000
25000000
80000000
9000000
3000000
55000000
50000000
50000000
60000000
20000000
30000000
10000000
30000000
1000000
2100000
3000000
100000
1000000
3000000
5000000
1000000
26000000
11000000
26000000
4500000
4500000
250000
1500000
2000000
1000000
2000000
1020000000
540000000
311000000
540000000
20250000
28000000
12500000
28000000
12500000
200000
40000
7000000
10000000
8350000
10000000
539500000
535000000
500000000
553000000
500000000
1000000
1000000
5675000
5600000
5750000
5600000
1000000
1000000
4250000
6000000
2500000
6000000
4000000
4100000
15000000
1200000
15000000
500000
500000
3000000
30000000
3000000
3500000
11500000
11500000
2000000000
2000000000
2000000
1500000
2000000
1000000
1000000
2750000
2000000
2750000
1500000
1000000
3000000
1500000
31000000
31000000
10000000
31000000
1000000
1000000
18750000
15000000
12500000
12500000
15000000
25000000
12500000
6375000
6250000
6500000
6500000
18750000
7500000
10000000
30000000
8000000
7500000
800000
800000
5250000
4500000
6000000
4500000
860000
720000
720000
1000000
720000
1850000
1000000
2700000
1000000
354000000
213000000
350000000
358000000
350000000
4000000
4000000
4000000
1000000
1000000
5600000000
12000000000
5900000000
12700000
12700000
12700000
33500000
33500000
33500000
66000000
75000000
66000000
100000000
66000000
100000000
100000000
92000000
100000000
100000000
28400000
28400000
7500000
7500000
7500000
47350000000
16500000000
40000000000
20000000000
3550000
2100000
2100000
5000000
2100000
50000000
50000000
50000000
2000000000
2000000000
2000000000
4000000000
2000000000
38000000
20000000
56000000
20000000
300000000
200000000
300000000
300000000
1000000
1000000


year=scan()
1906
1906
1906
1906
1906
1909
1915
1915
1918
1918
1918
1920
1925
1925
1925
1925
1927
1933
1933
1933
1935
1935
1935
1936
1938
1940
1940
1940
1940
1941
1941
1944
1944
1944
1946
1946
1946
1949
1949
1949
1949
1949
1951
1952
1952
1952
1952
1952
1952
1952
1952
1954
1954
1955
1955
1955
1957
1957
1957
1959
1959
1959
1961
1961
1961
1962
1962
1962
1962
1964
1964
1964
1964
1965
1965
1965
1965
1965
1966
1967
1969
1969
1969
1969
1971
1971
1971
1971
1971
1973
1973
1973
1973
1973
1973
1975
1975
1975
1975
1975
1975
1975
1975
1978
1978
1978
1979
1979
1979
1979
1979
1980
1980
1980
1980
1980
1980
1980
1980
1980
1980
1980
1980
1980
1981
1981
1981
1981
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1983
1984
1984
1984
1984
1984
1984
1986
1986
1986
1986
1986
1986
1986
1986
1986
1986
1986
1986
1986
1986
1986
1987
1987
1987
1987
1987
1987
1987
1987
1989
1989
1989
1989
1989
1990
1990
1990
1991
1991
1991
1992
1992
1992
1992
1992
1992
1992
1992
1992
1992
1993
1993
1993
1993
1993
1994
1994
1994
1994
1994
1994
1994
1994
1994
2000
2000
2000
2001
2001
2001
2001
2001
2002
2002
2002
2002
2003
2003
2003
2003
2004
2004

Data2= data.frame(year, Losses)


Annual_new1 = Data1$Annual[match(Data2$year, Data1$Year)]

Data2$CPI= Annual_new1

Data2$Adjusted_Losses = (Data2$Losses)*(282.920/Data2$CPI)

Date=scan( , what="",sep="")
4-18-1906
4-18-1906
4-18-1906
4-18-1906
4-18-1906
10-29-1909
6-22-1915
6-23-1915
4-21-1918
10-11-1918
10-11-1918
6-22-1920
6-28-1925
6-29-1925
6-29-1925
6-29-1925
1-1-1927
3-11-1933
3-11-1933
3-11-1933
10-19-1935
10-19-1935
10-31-1935
7-16-1936
1-23-1938
5-19-1940
5-19-1940
5-19-1940
5-19-1940
7-1-1941
11-14-1941
9-5-1944
9-5-1944
9-5-1944
2-15-1946
4-1-1946
4-1-1946
4-13-1949
4-13-1949
4-13-1949
4-13-1949
11-18-1949
8-15-1951
7-21-1952
7-21-1952
7-21-1952
7-21-1952
8-22-1952
8-22-1952
8-22-1952
8-22-1952
2-21-1954
12-21-1954
1-25-1955
9-5-1955
10-24-1955
3-9-1957
3-9-1957
3-22-1957
8-18-1959
8-18-1959
8-18-1959
4-4-1961
4-4-1961
4-29-1961
8-30-1962
8-30-1962
8-30-1962
8-30-1962
3-28-1964
3-28-1964
3-28-1964
3-28-1964
4-29-1965
4-29-1965
4-29-1965
4-29-1965
4-29-1965
1-23-1966
5-21-1967
10-2-1969
10-2-1969
10-2-1969
10-2-1969
2-9-1971
2-9-1971
2-9-1971
2-9-1971
2-9-1971
2-21-1973
2-21-1973
4-26-1973
4-26-1973
4-26-1973
4-26-1973
3-28-1975
3-28-1975
8-1-1975
8-1-1975
8-1-1975
8-1-1975
11-29-1975
11-29-1975
8-13-1978
8-13-1978
8-13-1978
8-6-1979
8-6-1979
10-15-1979
10-15-1979
10-15-1979
1-24-1980
1-24-1980
1-24-1980
5-18-1980
5-18-1980
5-25-1980
5-25-1980
5-25-1980
7-27-1980
7-27-1980
11-8-1980
11-8-1980
11-8-1980
4-26-1981
4-26-1981
4-26-1981
4-26-1981
5-2-1983
5-2-1983
5-2-1983
5-2-1983
7-12-1983
7-12-1983
10-28-1983
10-28-1983
10-28-1983
10-28-1983
10-28-1983
10-28-1983
10-28-1983
11-16-1983
11-16-1983
11-16-1983
11-16-1983
4-24-1984
4-24-1984
4-24-1984
4-24-1984
4-24-1984
4-24-1984
1-26-1986
1-26-1986
7-8-1986
7-8-1986
7-8-1986
7-8-1986
7-13-1986
7-13-1986
7-13-1986
7-13-1986
7-13-1986
7-21-1986
7-21-1986
7-21-1986
7-21-1986
10-1-1987
10-1-1987
10-1-1987
10-1-1987
10-1-1987
11-24-1987
11-24-1987
11-24-1987
6-26-1989
6-26-1989
10-18-1989
10-18-1989
10-18-1989
2-28-1990
2-28-1990
2-28-1990
6-28-1991
6-28-1991
6-28-1991
4-25-1992
4-25-1992
4-25-1992
4-25-1992
4-25-1992
6-28-1992
6-28-1992
6-28-1992
6-28-1992
6-28-1992
3-25-1993
3-25-1993
9-21-1993
9-21-1993
9-21-1993
1-17-1994
1-17-1994
1-17-1994
1-17-1994
12-26-1994
12-26-1994
12-26-1994
12-26-1994
12-26-1994
9-3-2000
9-3-2000
9-3-2000
2-28-2001
2-28-2001
2-28-2001
2-28-2001
2-28-2001
11-3-2002
11-3-2002
11-3-2002
11-3-2002
12-22-2003
12-22-2003
12-22-2003
12-22-2003
7-26-2004
9-28-2004

Data2$Date = Date

Data_CPI= read.csv( "C://Users//u0130739//Desktop//CPIAUCSL.csv", header=TRUE)

Year =  format(as.Date(Data_CPI$DATE), "%Y")

Data_CPI$Year = as.numeric(Year)

Data_CPI = Data_CPI[-dim(Data_CPI)[1], ]

Data_CPI$CPIAUCSL = as.numeric(Data_CPI$CPIAUCSL)

Interpolate = splinefun(Data_CPI$Year, Data_CPI$CPIAUCSL, method = "monoH.FC")

Interpolate(1906:1946)

func=approxfun(Data_CPI$Year, Data_CPI$CPIAUCSL)

Data_CPI$pred1 <- predict(lm(CPIAUCSL ~ poly(Year, 2), data=Data_CPI), newdata= data.frame(Year=c(1906:1946) ) )

Z=predict(lm(CPIAUCSL ~ poly(Year, 2), data=Data_CPI), newdata= data.frame(Year=c(1906:1946) ) )

library(ggplot2)
library(mgcv)

p1 <- ggplot(Data_CPI, aes(x = Year, y=CPIAUCSL)) +
  geom_line() +
  geom_point()+
  geom_hline(aes(yintercept=0))+
  geom_line(aes(y = pred1), color="red", data =Data_CPI)


approxExtrap(Data_CPI$Year,Data_CPI$CPIAUCSL , xout = 1906:1946)

mod_gam1 <- gam( CPIAUCSL~ s(Year), data=Data_CPI)

mod_gam1 = gam(CPIAUCSL ~ s(Year, k=3), data = Data_CPI, method = "REML")

plot(mod_gam1, residuals = TRUE, pch = 1)

mod_gam2 <- gam( CPIAUCSL~ s(Year, k= 10), data=Data_CPI, method = "REML")

par(mfrow = c(1, 2))
plot(mod_gam1, residuals = TRUE, pch = 1)
plot(mod_gam2, residuals = TRUE, pch = 1)

gam_mod_s1 <- gam(CPIAUCSL ~ s(Year), data = Data_CPI, sp = 0.1)

gam_mod_s2 <- gam(CPIAUCSL ~ s(Year), data = Data_CPI, sp = 0.0001)

par(mfrow = c(2, 1))
plot(gam_mod_s1, residuals = TRUE, pch = 1)
plot(gam_mod_s2, residuals = TRUE, pch = 1)

gam_mod_sk <- gam( CPIAUCSL~ s(Year, k = 10), data = Data_CPI, sp = 0.0001)

plot(gam_mod_sk, residuals = TRUE, pch = 1)


#####################################################
ggplot(Data_CPI, aes(Year, CPIAUCSL)) +
  geom_point()

# Examine the data frame

plot(Data_CPI$Year, Data_CPI$CPIAUCSL)

# Fit a linear model
lm_mod <- lm( CPIAUCSL~ Year, data = Data_CPI)
 
ggplot(Data_CPI, aes( Year, CPIAUCSL)) +
  geom_point() +
  geom_smooth(method = lm)

plot(lm_mod, which = 1)

ggplot(Data_CPI, aes(Year, CPIAUCSL)) +
  geom_point() +
  geom_smooth(method = "gam")

# Visualize the model
termplot(lm_mod, partial.resid = TRUE, se = TRUE)
plot(lm_mod, residuals = TRUE, pch = 1)

# Load mgcv
library(mgcv)

# Fit the model
gam_mod <- gam(CPIAUCSL ~ s(Year), data = Data_CPI)

# Plot the results
plot(gam_mod, residuals = TRUE, pch = 1)

# Extract the model coefficients
coef(gam_mod)

gam_mod <- gam(CPIAUCSL ~ s(Year, bs = "cs"), data = Data_CPI, method = "REML" )
gam_mod$sp


plot(gam_mod, residuals = TRUE, pch = 1)

gam_pred <- predict(gam_mod, newdata = data.frame(Year = c(1906:1946)))

print(gam_pred)

Data2= data.frame(year, Losses)

Data_CPI_new = data.frame(Year = c(1906:1946, Data_CPI$Year), CPI = c(gam_pred, Data_CPI$CPIAUCSL))


CPI_new = Data_CPI_new$CPI[match(Data2$year, Data_CPI_new$Year)]


Data2$CPI= CPI_new

Data2$Adjusted_Losses = (Data2$Losses)*(258.838250/Data2$CPI)

library("writexl")

write_xlsx(Data2,"C://Users//u0130739//Desktop//Final_Dataset.xlsx")

